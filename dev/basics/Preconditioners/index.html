<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Preconditioners · LinearSolve.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://linearsolve.sciml.ai/stable/basics/Preconditioners/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="LinearSolve.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">LinearSolve.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/linear/">Solving Linear Systems in Julia</a></li><li><a class="tocitem" href="../../tutorials/caching_interface/">Linear Solve with Caching Interface</a></li></ul></li><li><span class="tocitem">Basics</span><ul><li><a class="tocitem" href="../LinearProblem/">Linear Problems</a></li><li><a class="tocitem" href="../CachingAPI/">Caching Interface API Functions</a></li><li class="is-active"><a class="tocitem" href>Preconditioners</a><ul class="internal"><li><a class="tocitem" href="#Using-Preconditioners"><span>Using Preconditioners</span></a></li><li><a class="tocitem" href="#Pre-Defined-Preconditioners"><span>Pre-Defined Preconditioners</span></a></li><li><a class="tocitem" href="#Preconditioner-Interface"><span>Preconditioner Interface</span></a></li></ul></li><li><a class="tocitem" href="../FAQ/">Frequently Asked Questions</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../../solvers/solvers/">Linear System Solvers</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Basics</a></li><li class="is-active"><a href>Preconditioners</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Preconditioners</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SciML/LinearSolve.jl/blob/master/docs/src/basics/Preconditioners.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Preconditioners"><a class="docs-heading-anchor" href="#Preconditioners">Preconditioners</a><a id="Preconditioners-1"></a><a class="docs-heading-anchor-permalink" href="#Preconditioners" title="Permalink"></a></h1><p>Many linear solvers can be accelerated by using what is known as a <strong>preconditioner</strong>, an approximation to the matrix inverse action which is cheap to evaluate. These can improve the numerical conditioning of the solver process and in turn improve the performance. LinearSolve.jl provides an interface for the definition of preconditioners which works with the wrapped packages.</p><h2 id="Using-Preconditioners"><a class="docs-heading-anchor" href="#Using-Preconditioners">Using Preconditioners</a><a id="Using-Preconditioners-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Preconditioners" title="Permalink"></a></h2><h3 id="Mathematical-Definition"><a class="docs-heading-anchor" href="#Mathematical-Definition">Mathematical Definition</a><a id="Mathematical-Definition-1"></a><a class="docs-heading-anchor-permalink" href="#Mathematical-Definition" title="Permalink"></a></h3><p>Preconditioners are specified in the keyword arguments of <code>init</code> or <code>solve</code>. The right preconditioner, <code>Pr</code> transforms the linear system <span>$Au = b$</span> into the form:</p><p class="math-container">\[AP_r^{-1}(Pu) = AP_r^{-1}y = b\]</p><p>to add the solving step <span>$P_r u = y$</span>. The left preconditioner, <code>Pl</code>, transforms the linear system into the form:</p><p class="math-container">\[P_l^{-1}(Au - b) = 0\]</p><p>A two-sided preconditioned system is of the form:</p><p class="math-container">\[P_l A P_r^{-1} (P_r u) = P_l b\]</p><p>By default, if no preconditioner is given the preconditioner is assumed to be the identity <span>$I$</span>.</p><h3 id="Using-Preconditioners-2"><a class="docs-heading-anchor" href="#Using-Preconditioners-2">Using Preconditioners</a><a class="docs-heading-anchor-permalink" href="#Using-Preconditioners-2" title="Permalink"></a></h3><p>In the following, we will use the <code>DiagonalPreconditioner</code> to define a two-sided preconditioned system which first divides by some random numbers and then multiplies by the same values. This is commonly used in the case where if, instead of random, <code>s</code> is an approximation to the eigenvalues of a system.</p><pre><code class="language-julia hljs">s = rand(n)
Pl = LinearSolve.DiagonalPreconditioner(s)

A = rand(n,n)
b = rand(n)

prob = LinearProblem(A,b)
sol = solve(prob,IterativeSolvers_GMRES(),Pl=Pl)</code></pre><h2 id="Pre-Defined-Preconditioners"><a class="docs-heading-anchor" href="#Pre-Defined-Preconditioners">Pre-Defined Preconditioners</a><a id="Pre-Defined-Preconditioners-1"></a><a class="docs-heading-anchor-permalink" href="#Pre-Defined-Preconditioners" title="Permalink"></a></h2><p>To simplify the usage of preconditioners, LinearSolve.jl comes with many standard preconditioners written to match the required interface.</p><ul><li><code>DiagonalPreconditioner(s::Union{Number,AbstractVector})</code>: the diagonal preconditioner, defined as a diagonal matrix <code>Diagonal(s)</code>.</li><li><code>InvDiagonalPreconditioner(s::Union{Number,AbstractVector})</code>: the diagonal preconditioner, defined as a diagonal matrix <code>Diagonal(1./s)</code>.</li><li><code>ComposePreconditioner(prec1,prec2)</code>: composes the preconditioners to apply <code>prec1</code> before <code>prec2</code>.</li></ul><h2 id="Preconditioner-Interface"><a class="docs-heading-anchor" href="#Preconditioner-Interface">Preconditioner Interface</a><a id="Preconditioner-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#Preconditioner-Interface" title="Permalink"></a></h2><p>To define a new preconditioner you define a Julia type which satisfies the following interface:</p><ul><li><code>Base.eltype(::Preconditioner)</code></li><li><code>LinearAlgebra.ldiv!(::AbstractVector,::Preconditioner,::AbstractVector)</code></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../CachingAPI/">« Caching Interface API Functions</a><a class="docs-footer-nextpage" href="../FAQ/">Frequently Asked Questions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Sunday 19 December 2021 12:31">Sunday 19 December 2021</span>. Using Julia version 1.7.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
